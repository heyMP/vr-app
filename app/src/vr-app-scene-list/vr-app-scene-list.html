<link rel="import" href="../../bower_components/apollo-client/graphql-query.html">
<link rel="import" href="../../bower_components/paper-card/paper-card.html">
<link rel="import" href="../../bower_components/paper-card/paper-card-header.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">

<dom-module id="vr-app-scene-list">
  <template>
    <style>
      :host {
        display: block;
      }

      paper-card {
        max-width: 400px;
        --paper-card-header-text: {
          background: rgba(255,255,255, 0.5);
          margin: .5em;
          padding: .5em;
        }
      }
    </style>
    <graphql-query result="{{data}}">
      query {
        nodeQuery(offset: 0, limit: 100, filter: { type: "Tutorial"}) {
          count
          entities {
            entityUuid
            ... on NodeTutorial {
              title
              summary: fieldSummary {
                value: processed
              }
              fieldImage {
                ... on FieldNodeFieldImage {
                  entity {
                    thumbnail {
                      alt
                      title
                      derivative(style: "large") {
                        url
                      }
                    }
                  } 
                }
              }
              uid {
                entity {
                  name
                }
              }
            }
          }
        }
      }
    </graphql-query>

    <template is="dom-if" if="[[data]]">
      <template is="dom-repeat" items="[[data.nodeQuery.entities]]" items="item">
        <paper-card heading="[[item.title]]" image="[[item.fieldImage.entity.thumbnail.derivative.url]]" elevation="1" animated-shadow="false">
          <div class="card-body">author: [[item.uid.entity.name]]</div>
          <div class="card-actions">
            <a href$="[[__formatUrl(item.entityUuid)]]"> View Scene </a>
          </div>
        </paper-card>
      </template>
    </template>


  </template>
  <script>
    Polymer({
      is: 'vr-app-scene-list',
      __formatUrl: function (uuid) {
        return `http://localhost:81/scene/${uuid}`;
      }
    });
  </script>
</dom-module>