<link rel="import" href="../../bower_components/apollo-client/graphql-query.html">
<link rel="import" href="../../bower_components/apollo-client/graphql-mutation.html">
<link rel="import" href="../../bower_components/paper-card/paper-card.html">
<link rel="import" href="../../bower_components/paper-card/paper-card-header.html">

<dom-module id="vr-app-scene-list">
  <template>
    <style>
      :host {
        display: block;
      }

      paper-card {
        max-width: 400px;
      }
    </style>
    <graphql-query result="{{data}}">
      query {
        nodeQuery(limit: 10, offset: 0, filter: {type: "Scene", status: true}) {
          entities {
            ... on NodeScene {
              title
              uuid
              fieldImage {
                ... on FieldNodeFieldImage {
                  entity {
                    thumbnail {
                      derivative(style: thumbnail) {
                        url
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    </graphql-query>

    <template is="dom-if" if="[[data]]">
      <template is="dom-repeat" items="[[data.nodeQuery.entities]]">
        
        <paper-card heading="[[item.title]]" image="[[item.fieldImage.entity.thumbnail.derivative.url]]" elevation="1" animated-shadow="false">
          <div class="card-actions">
            <a href$="[[__formatUrl(item.uuid)]]">
              <paper-button>View</paper-button>
            </a>
          </div>
        </paper-card>
        
      </template>
    </template>
  </template>
  <script>
    Polymer({
      is: 'vr-app-scene-list',
      properties: {
        data: {
          type: Object,
          observer: '__scenesChanged'
        }
      },
      __formatUrl: function (uuid) {
        return `http://localhost:81/scene/${uuid}`;
      }
    });
  </script>
</dom-module>

