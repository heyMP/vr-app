<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../../bower_components/apollo-client/graphql-client.html" />
<link rel="import" href="../../bower_components/apollo-client/graphql-query.html" />
<script src="../../bower_components/apollo-client/build/apollo-client.js"></script>

<dom-module id="vr-app-root">
  <template>
    <style>
      :host {
        display: block;
        background: #f3f3f3;
        padding: 1em;
        margin: 0;
      }
    </style>

  <template is="dom-if" if="[[data]]">
    <h1>Tutorials ([[data.nodeQuery.entities.length]])</h1>
    <ul>
    <template is="dom-repeat" items="[[data.nodeQuery.entities]]" items="item">
      <li>[[item.title]]</li>
    </template>
    </ul>
  </template>

    <graphql-client config='{ "uri": "http://localhost/graphql" }'></graphql-client>
    <graphql-query result="{{data}}">
        query {
          nodeQuery(offset: 0, limit: 100, filter: { type: "Tutorial"}) {
            count
            entities {
              entityUuid
              ... on NodeTutorial {
                title
                summary: fieldSummary {
                  value: processed
                }
                fieldImage {
                  ... on FieldNodeFieldImage {
                    entity {
                      thumbnail {
                        alt
                        title
                        derivative(style: "large") {
                          url
                        }
                      }
                    } 
                  }
                }
                uid {
                  entity {
                    name
                  }
                }
              }
            }
          }
        }
    </graphql-query>

  </template>

  <script>
    Polymer({

      is: 'vr-app-root',

      properties: {
      },

      /**
       * Listen for request for getScene
       */
      __getTutorialsHandler: function (e) {
        this.data = e.detail.response.data;
      },

    });
  </script>
</dom-module>